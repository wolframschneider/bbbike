#!/usr/bin/perl -w
# -*- perl -*-

#
# $Id: check_double,v 1.5 2002/11/06 15:28:22 eserte Exp $
# Author: Slaven Rezic
#
# Copyright (C) 1998,2009 Slaven Rezic. All rights reserved.
# This program is free software; you can redistribute it and/or
# modify it under the same terms as Perl itself.
#
# Mail: eserte@cs.tu-berlin.de
# WWW:  http://user.cs.tu-berlin.de/~eserte/
#

use strict;
use FindBin;
use lib ("$FindBin::RealBin/..", "$FindBin::RealBin/../lib");
use Strassen;

unshift(@Strassen::datadirs, "$FindBin::RealBin/../data");

my @files = @ARGV;
die "File?" if !@files;

my @obj;
foreach my $file (@files) {
    my $obj = new Strassen $file;
    die "Can't create obj for $file" if !$obj;
    push @obj, $obj;
}

my $o = new MultiStrassen @obj;

my %h;
$o->init;
while(1) {
    my $r = $o->next;
    last if !@{$r->[1]};
    $h{$r->[0]}++;
}

my @double;
while(my($k,$v) = each %h) {
    if ($v > 1) {
	push @double, $k;
    }
}

if (@double) {
    print join("\n", map { "$_\t$h{$_}" } sort @double), "\n";
    exit 1;
}
