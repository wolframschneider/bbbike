language: c
sudo: required
matrix:
  include:
    - os: linux
      dist: trusty
      compiler: clang
      env:
       - MY_OS=trusty

addons:
 apt:
  packages:
   - make

before_install:
  - git clone --depth=50 --branch=world https://github.com/wosch/bbbike-world.git world
  - . ./world/etc/env/dot.bbbikerc 
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then DEBUG=true ./world/travis/bbbike-init.sh; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y libdata-random-perl; fi # ????
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y bbbike-world; fi
  ## mono stuff
  #- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y mono-devel xvfb x11-apps; fi
  #- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo world/etc/init.d/xvfb start; fi

before_script:
 - true

script:
 - make -f world/Makefile.osm create-bbbike-web-symlinks
 - make bbbike-bootstrap
 - make update-files
 - BBBIKE_MAPERITIVE_DISABLED=1 BBBIKE_TEST_TRAVIS=1 make travis
