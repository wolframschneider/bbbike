Required perl modules:
------------------------------------

see ../bin/bbbike-build-runtime-perl.pl

apt-get install -y libhtml-tagcloud-perl libhtml-parser-perl \
  libxml-atom-simplefeed-perl tidy sudo git vim make
#perlmagick imagemagick


curl -sSfL https://github.com/wolframschneider/bbbike/raw/world/world/bin/bbbike-tarball > bbbike-tarball
curl -sSfL https://github.com/wolframschneider/bbbike/raw/world/world/bin/bbbike-checkout > bbbike-checkout
chmod a+x bbbike-checkout bbbike-tarball
./bbbike-tarball
./bbbike-checkout


Required debian modules
------------------------------------


/etc/apt/sources.list:
## backports
#deb     http://mirror.hetzner.de/debian/backports squeeze-backports main contrib non-free
#deb     http://backports.debian.org/debian-backports squeeze-backports main contrib non-free
deb	http://ftp-stud.hs-esslingen.de/debian-backports squeeze-backports main contrib non-free

# see world/etc/apt/equivs
sudo apt-get install bbbike-world 

# reverse proxy
sudo apt-get install varnish


Required MacPorts modules
------------------------------------
sudo port install pbzip2 bzip2 git-core lynx wget \
	pigz buffer tidy pdftk htop \
	p5-yaml p5-bsd-resource p5-uri p5-json p5-xml-simple p5-tie-ixhash \
	p5-yaml-syck p5-yaml p5-perl-tidy p5-libwww-perl p5-perlio-gzip \
	p5-perl-tidy p5-extutils-makemaker p5-module-build p5-inline \
	p5-archive-zip p5-date-calc p5-template-toolkit p5-image-info \
	p5-www-mechanize p5-xml-twig p5-perl-tidy p5-algorithm-diff \
	p5-image-exiftool p5-mime-tools p5-ipc-run p5-statistics-descriptive \
	p5-dbi p5-class-accessor p5-data-compare p5-math-matrix p5-cairo \
	p5-svg p5-yaml-tiny p5-gd-svg p5-perlmagick libxml2

sudo port install lighttpd munin varnish openjdk6 

brew install node.js pbzip2 git lynx wget tidy


sudo_cpan="sudo cpan-5.12"
$sudo_cpan BSD::Resource
$sudo_cpan Text::Unidecode
$sudo_cpan HTML::TagCloud
$sudo_cpan Object::Realize::Later
$sudo_cpan Email::Valid
$sudo_cpan Geo::METAR
$sudo_cpan Imager
$sudo_cpan Text::CSV_XS
$sudo_cpan Capture::Tiny
$sudo_cpan XML::LibXML::Reader
$sudo_cpan Image::Info
#$sudo_cpan PerlIO::gzip
$sudo_cpan accessors

# optional/devel
$sudo_cpan Devel::Leak
$sudo_cpan JSON::XS
$sudo_cpan File::ReadBackwards
$sudo_cpan HTML::TreeBuilder::XPath
$sudo_cpan HTML::FormatText
$sudo_cpan PDF::Create
$sudo_cpan Text::Table
$sudo_cpan String::Approx
$sudo_cpan DB_File::Lock
$sudo_cpan Imager
$sudo_cpan XBase
$sudo_cpan CDB_File

# MacOS 
$ egrep  -h ^use ./world/bin/bbbike-build-runtime-perl*.pl |perl -npe 's,use,\$sudo_cpan,g; s/;//' | sort -u

############################################
# fresh maschine
#
# rm -rf ~/projects ~/tmp ~/.ssh/config ~/.ssh/known_hosts ~/src/bbbike.tgz
# sudo rm -rf /bbbike /usr/local/www /var/cache/bbbike /usr/local/bin
#
su -
apt-get install -y git-core sudo </dev/null
echo 'indexdata   ALL=NOPASSWD: ALL' >> /etc/sudoers
echo 'deb http://debian.bbbike.org/debian/wheezy wheezy main' > /etc/apt/sources.list.d/bbbike.list 
echo 'StrictHostKeyChecking=no' >> /etc/ssh/ssh_config 
mkdir -p /usr/local/bin

mkdir -p ~/.ssh
mkdir -p ~/projects
mkdir -p ~/tmp
echo 'User wosch' > ~/.ssh/config

# create .ssh/authorized_keys

( cd ~/projects; git clone ssh://git.calaminus.com:222/home/wosch/git/wosch-ssh-config )
( cd ~/.ssh/ && ln -fs ../projects/wosch-ssh-config/config )

( cd ~/tmp/ && git clone ssh://git.bbbike.org/home/git/bbbike )
( cd ~/tmp/bbbike/world/etc/apt/wheezy/gpg && sudo apt-key add bbbike.asc )
sudo apt-get update -qq
sudo apt-get install -y bbbike-world </dev/null

( cd ~/tmp/bbbike; make -s -f world/Makefile.osm create-perl-symlink create-bbbike-web-symlinks )
( cd ~/tmp/bbbike; make TYPE2LEGEND=true bbbike-tarball )
( sudo mkdir -p /usr/local/www )
( cd /usr/local/www && sudo chown $(logname) . &&  ~/tmp/bbbike/world/bin/bbbike-checkout )
( cd /usr/local/www && ln -sf bbbike bbbike.org )
( cd ~/tmp/bbbike; make -s bbbike-bootstrap )
. ~/.bashrc 
( cd ~/projects/; ~/tmp/bbbike/world/bin/bbbike-checkout )
( cd ~/projects/bbbike; make -s update-files )
( cd ~/projects/bbbike; make -s staging )
( cd ~/projects/bbbike; make check )

