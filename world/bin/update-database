#!/bin/sh
# Copyright (c) 2009-2011 Wolfram Schneider, http://bbbike.org
#
# wrapper for Makefile bug
#

set -e

tmp=tmp
mkdir -p $tmp

: ${bbbike_cleanup="planet-download"}
ionice=`which ionice`
if [ "$ionice" != "" ]; then
   ionice_opt="-c 3"
fi

begin="`date`"
for i in $bbbike_cleanup cities-parallel convert-wgs84 convert-bbbike update-files
do
	\time $ionice $ionice_opt make -s $i > tmp/log.$i 2>&1
done

# set an notice
(  echo "begin: $begin"
   echo "end:   `date`" ) | mail -s "$0/done" `whoami`

