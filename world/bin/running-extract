#!/bin/sh
# Copyright (c) 2012-2013 Wolfram Schneider, http://bbbike.org
#
# running-extract - xyz

set -e

dir=extract

case $0 in 
    *pro ) dir="extract-pro";;
esac

: ${extract_dir=/var/cache/$dir/running}
if [ -z "$1" ]; then
   term=.
else
   term="\"$1\""
fi

if [ $(ls $extract_dir/*/*json 2>/dev/null | wc -l ) -gt 0 ]; then
    ( cat $extract_dir/*/*json 
      echo '    "processes": "'$(ls $extract_dir/*.pid 2>/dev/null | wc -l)'"' ) |
	egrep $term
fi

