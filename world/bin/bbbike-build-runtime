#!/bin/sh
# Copyright (c) 2009-2013 Wolfram Schneider, http://bbbike.org
#
# test if all programs are installed
#

set -e

commands="
gzip
bzip2
buffer
curl
git
iconv
java
jsbeautifier
jsmin
make
osmosis
perltidy
python
rsync
time
wget
xargs
osmconvert
"

tmpdirs="/bbbike/tmp /tmpfs"
for c in $tmpdirs
do
   if [ ! -d $c ]; then
	echo "missing temp directory: $c"
	error=1
   fi
done

for c in $commands
do
    if which $c >/dev/null; then :
    else
	echo "missing: $c"
	   error=1
    fi
done

commands_optional="
pigz
pbzip2
pixz
"
for c in $commands_optional
do
    if which $c >/dev/null; then :
    else
	echo "missing optional: $c"
    fi
done

# md5
if ( which md5 || which md5sum ) >/dev/null; then :
else
   echo "missing: md5"
   error=1
fi

exit $error

